generator client {
    provider = "prisma-client-js"
}

generator zod {
    provider      = "zod-prisma"
    output        = "../app/models/schema/"
    relationModel = true

    modelCase = "PascalCase"

    modelSuffix = "Model"

    useDecimalJs = true
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Image {
    uuid    String @id @default(uuid())
    url     String @default("")
    block   Block  @relation(fields: [blockId], references: [uuid])
    blockId String @unique
}

model Sequence {
    uuid    String   @id @default(uuid())
    title   String
    steps   String[]
    block   Block    @relation(fields: [blockId], references: [uuid])
    blockId String   @unique
}

model Text {
    uuid    String @id @default(uuid())
    content String @default("")
    block   Block  @relation(fields: [blockId], references: [uuid])
    blockId String @unique
}

enum ColorMetaStates {
    PROJECT_BACKGROUND_LIGHT
    PROJECT_BACKGROUND_DARK
    PROJECT_ACCENT_COLOR
    GLOWING
    JUST_A_BEAUTIFUL_COLOR
}

model Color {
    uuid    String          @id @default(uuid())
    hex     String          @default("")
    name    String          @default("")
    block   Block           @relation(fields: [blockId], references: [uuid])
    blockId String          @unique
    meta    ColorMetaStates @default(JUST_A_BEAUTIFUL_COLOR)
}

enum BlockSize {
    SM
    MD
    LG
    COVER
    AUTO
}

model Block {
    /// The unique identifier for the post
    /// @default {Generated by database}
    uuid String @id @default(uuid())

    /// Index of the Block inside a project
    /// @zod.min(0)
    index Int

    /// width of the block
    width  BlockSize
    /// height of the block
    height BlockSize

    project   Project @relation(fields: [projectId], references: [uuid])
    projectId String

    color    Color?
    image    Image?
    sequence Sequence?
    text     Text?
}

model Project {
    uuid        String   @id @default(uuid())
    createdAt   DateTime @default(now())
    name        String
    description String
    coverImage  String   @default("")
    slug        String   @unique
    index       Int
    owner       Profile  @relation(fields: [ownerId], references: [uuid])
    ownerId     String
    isPublic    Boolean
    isArchived  Boolean  @default(false)

    blocks Block[]
}

model Profile {
    uuid     String    @id
    email    String    @default("")
    name     String    @default("")
    projects Project[]
}
